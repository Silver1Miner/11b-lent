[gd_scene load_steps=3 format=2]

[ext_resource path="res://assets/ui/UI.tres" type="Theme" id=2]

[sub_resource type="GDScript" id=1]
script/source = "extends ColorRect

var current_slot = 0
onready var slot_list = $SaveOptions/SaveSlots
onready var save_button = $SaveOptions/Save
onready var load_button = $SaveOptions/Load

func _ready() -> void:
	load_slot_names()

func load_slot_names() -> void:
	slot_list.clear()
	for i in range(5):
		slot_list.add_item(\"Entry \" + str(i+1) + \": \" + PlayerData.get_save_date(i))
	save_button.disabled = true
	load_button.disabled = true

func _on_Close_pressed() -> void:
	visible = false

func _on_Load_pressed() -> void:
	print(\"load file \", str(current_slot))
	PlayerData.load_player_data(PlayerData.load_game(current_slot))
	visible = false
	if get_tree().change_scene_to(PlayerData.hub_scene) != OK:
		push_error(\"fail to change scene\")

func _on_Save_pressed() -> void:
	PlayerData.save_game(current_slot)
	print(\"save file \", str(current_slot))
	visible = false

func _on_SaveSlots_item_selected(index: int) -> void:
	current_slot = index
	print(current_slot)
	save_button.disabled = false
	if PlayerData.get_save_date(index) != \"no save entry\":
		load_button.disabled = false
	else:
		load_button.disabled = true
"

[node name="SaveMenu" type="ColorRect"]
anchor_right = 1.0
anchor_bottom = 1.0
theme = ExtResource( 2 )
color = Color( 0, 0, 0, 0.784314 )
script = SubResource( 1 )

[node name="SaveOptions" type="VBoxContainer" parent="."]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -150.0
margin_top = -107.5
margin_right = 150.0
margin_bottom = 107.5

[node name="Saves" type="Label" parent="SaveOptions"]
margin_right = 300.0
margin_bottom = 19.0
rect_min_size = Vector2( 300, 0 )
text = "SAVES"
align = 1
valign = 1

[node name="SaveSlots" type="ItemList" parent="SaveOptions"]
margin_top = 23.0
margin_right = 300.0
margin_bottom = 148.0
rect_min_size = Vector2( 0, 125 )

[node name="Save" type="Button" parent="SaveOptions"]
margin_top = 152.0
margin_right = 300.0
margin_bottom = 177.0
text = "SAVE"

[node name="Load" type="Button" parent="SaveOptions"]
margin_top = 181.0
margin_right = 300.0
margin_bottom = 206.0
text = "LOAD"

[node name="Close" type="Button" parent="SaveOptions"]
margin_top = 210.0
margin_right = 300.0
margin_bottom = 235.0
text = "CLOSE"

[connection signal="item_selected" from="SaveOptions/SaveSlots" to="." method="_on_SaveSlots_item_selected"]
[connection signal="pressed" from="SaveOptions/Save" to="." method="_on_Save_pressed"]
[connection signal="pressed" from="SaveOptions/Load" to="." method="_on_Load_pressed"]
[connection signal="pressed" from="SaveOptions/Close" to="." method="_on_Close_pressed"]
